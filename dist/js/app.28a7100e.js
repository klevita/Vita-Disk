(function(){"use strict";var e={5208:function(e,t,a){var i=a(144),s=a(998),r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(s.Z,[t("BaseLayout",[t("router-view")],1)],1)},o=[],l=a(3675),n=a(6190),c=a(4127),u=a(8718),d=a(7149),f=a(7953),h=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"base-layout-wrapper"},[t(l.Z,{attrs:{elevation:2}},[t(f.qW,[e._v("Vita Disk")]),t(u.Z),t(c.Z,[e._v(" "+e._s((e.$store.state.weight/1e6).toFixed(3)+" мб")+" ")]),t(u.Z),t("div",{staticClass:"d-flex pt-6"},[t(d.Z,{attrs:{label:"фильтр: имя",clearable:""},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),t(d.Z,{staticClass:"ml-2",attrs:{label:"фильтр: расширение",clearable:""},model:{value:e.fileExtension,callback:function(t){e.fileExtension=t},expression:"fileExtension"}})],1),t(u.Z),"auth"!==e.$route.name?t(n.Z,{attrs:{text:"",to:{name:"auth"}}},[e._v(" выйти ")]):e._e()],1),t("div",{staticClass:"base-layout-slot-container"},[e._t("default")],2)],1)},p=[],m=i.ZP.extend({name:"BaseLayout",data:()=>({fileExtension:"",fileName:""}),mounted(){this.fileName=this.$store.state.fileNameSearch,this.fileExtension=this.$store.state.fileExtensionSearch},watch:{fileExtension(e){this.$store.commit("setFileExtensionSearch",e)},fileName(e){this.$store.commit("setFileNameSearch",e)}}}),x=m,v=a(1001),_=(0,v.Z)(x,h,p,!1,null,"2b546de4",null),Z=_.exports,b=i.ZP.extend({name:"App",data:()=>({}),components:{BaseLayout:Z}}),g=b,w=(0,v.Z)(g,r,o,!1,null,null,null),y=w.exports,F=a(8345),$=a(9582),E=a(1625),k=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"home-wrapper"},[t($.Z,{staticClass:"home-item-wrapper"},[t(E.Z,{staticStyle:{"margin-right":"20px"},attrs:{error:e.fileError,loading:e.fileLoading,messages:e.fileErrors,"show-size":"",label:"Загрузить файл"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),t(n.Z,{on:{click:function(t){return e.addFolder()}}},[e._v("Добавить папку")])],1),e._l(e.rawFoldersData,(function(e){return t("FolderComponent",{attrs:{folderData:e}})})),e._l(e.files,(function(e){return t("FileComponent",{key:e.id,attrs:{data:e}})}))],2)},S=[],C=(a(7658),a(6154)),z=a(7327),P=a(629);class D{static Login(e,t){return j(B.post(`/auth/login?email=${e}&password=${t}`))}static Logout(){return j(B.post("/auth/logout"))}static Register(e,t,a){return j(B.post(`/auth/register?email=${e}&name=${a}&password=${t}`))}}var L=a(4702);i.ZP.use(P.ZP);class N{constructor(){(0,z.Z)(this,"user",{email:"",token:""}),(0,z.Z)(this,"weight",0),(0,z.Z)(this,"fileNameSearch",""),(0,z.Z)(this,"fileExtensionSearch","")}}const T={setUser(e,t){e.user=t},setWeight(e,t){e.weight=t},setFileExtensionSearch(e,t){e.fileExtensionSearch=t||""},setFileNameSearch(e,t){e.fileNameSearch=t||""},dropUser(e){e.user={email:"",token:""}}},O={async fetchUser(e,t){const a=await D.Login(t.email,t.pass);a.data.errors||e.commit("setUser",{email:t.email,token:a.data.token})}};var R=new P.ZP.Store({state:new N,mutations:T,actions:O,plugins:[(0,L.Z)()]});async function j(e){try{let t=await e;return t.data}catch(t){return t.response}}var B=C.Z.create({baseURL:"http://45.131.41.20/api/v1/",headers:{Authorization:`Bearer ${R.state.user.token}`}});class U{static UploadFile(e,t=undefined){const a=new FormData;return a.append("file",e),t&&a.append("folder_id",""+t),j(B.post("/files",a))}static PublishFile(e){return j(B.post(`/files/${e}/publish`))}static GetFiles(e=null){return j(e?B.get(`/files?folder_id=${e}`):B.get("/files"))}static GetFileById(e=null){return j(B.get(`/files/${e}`))}static RenameFile(e,t){return j(B.patch(`/files/${e}?name=${t}`))}static DeleteFile(e){return j(B["delete"](`/files/${e}`))}static async DownloadFile(e){const t=await(0,C.Z)({url:"http://api.dev/file-download",method:"GET",responseType:"blob"});return t}}class G{static GetFolders(){return j(B.get("/folders"))}static AddFolder(e){return j(B.post(`/folders?name=${e}`))}}var q=a(4324),A=a(2761),I=function(){var e=this,t=e._self._c;e._self._setupProxy;return t($.Z,{staticClass:"file-card"},[t("div",{staticStyle:{display:"flex","align-items":"center",width:"calc(100% - 260px)"}},[t(d.Z,{on:{change:e.updateFile},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}}),t("div",{staticStyle:{"padding-left":"5px","padding-bottom":"2px"}},[e._v(" "+e._s(e.data.full_name.slice(e.data.full_name.lastIndexOf(".")))+" ")])],1),t(u.Z),t("div",{staticClass:"file-card-group"},[t(c.Z,[e._v(" "+e._s((e.data.size/1e6).toFixed(3)+" мб")+" ")]),t(n.Z,{staticClass:"mx-1",attrs:{text:"",icon:""},on:{click:function(t){return e.download()}}},[t(q.Z,{attrs:{medium:"",color:"blue"}},[e._v("mdi-file-download")])],1),t(A.Z,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[t(n.Z,{attrs:{text:"",icon:""},on:{click:function(t){return e.copyToClipboard()}}},[t(q.Z,{attrs:{medium:"",color:"blue"}},[e._v("mdi-share-variant")])],1)]}}]),model:{value:e.showTooltip,callback:function(t){e.showTooltip=t},expression:"showTooltip"}},[t("span",[e._v("Ссылка скопирована")])]),t(n.Z,{attrs:{text:"",icon:""},on:{click:function(t){return e.deleteFile()}}},[t(q.Z,{attrs:{medium:"",color:"red"}},[e._v("mdi-trash-can-outline")])],1)],1)],1)},W=[],M=i.ZP.extend({name:"FileComponent",data:()=>({showTooltip:!1}),props:{data:{required:!0,type:Object}},methods:{async deleteFile(){await U.DeleteFile(this.data.id),this.$destroy(),this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},async publishFile(){await U.PublishFile(this.data.id);let e=await U.GetFileById(this.data.id);this.data.public_url=e.data.public_url},updateFile(e){U.RenameFile(this.data.id,e)},async download(){this.data.public_url||this.publishFile();const e=document.createElement("a");e.download=this.data.name,e.href=this.data.public_url,document.body.appendChild(e),e.click(),document.body.removeChild(e)},async copyToClipboard(){this.data.public_url||this.publishFile(),this.showTooltip=!0,navigator.clipboard.writeText(this.data.public_url),setTimeout((()=>{this.showTooltip=!1}),1200)}}}),V=M,H=(0,v.Z)(V,I,W,!1,null,"f16f1034",null),J=H.exports,K=a(255),Q=a(2348),X=a(400),Y=a(5756),ee=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"folder-wrapper"},[t(Y.Z,[t(K.Z,[t(X.Z,{attrs:{color:"#F5F5F5"}},[t("span",[e._v(" "+e._s(e.folderData.name)+" ")]),t("div",{staticStyle:{display:"flex","justify-content":"end","margin-right":"80px"}},[t(c.Z,[e._v(" "+e._s((e.folderData.size/1e6).toFixed(3)+" мб")+" ")])],1)]),t(Q.Z,[t($.Z,{staticClass:"folder-item-wrapper"},[t(E.Z,{attrs:{error:e.fileError,loading:e.fileLoading,messages:e.fileErrors,"show-size":"",label:"Загрузить файл"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._l(e.files,(function(e){return t("FileComponent",{key:e.id,attrs:{data:e}})}))],2)],1)],1)],1)},te=[],ae=i.ZP.extend({name:"FolderComponent",data:()=>({fileLoading:!1,fileError:!1,fileErrors:[],file:void 0,rawFilesData:[]}),async mounted(){this.rawFilesData=(await U.GetFiles(this.folderData.id)).data},methods:{validateFile(e){return this.fileError=!1,this.fileErrors=[],!!e&&(e.size>2e7&&(this.fileError=!0,this.fileErrors.push("Размер файла не должен превышан 20мб")),".php"===e.name.slice(-4)&&(this.fileError=!0,this.fileErrors.push("Нельзя загружать .php файлы")),!this.fileErrors.length)},async processFile(e){if(this.validateFile(e)&&e){this.fileLoading=!0;await U.UploadFile(e,this.folderData.id);this.fileLoading=!1,this.rawFilesData=(await U.GetFiles(this.folderData.id)).data}}},computed:{files(){return this.rawFilesData.filter((e=>(!this.$store.state.fileExtensionSearch.length||e.full_name.slice(e.full_name.lastIndexOf(".")+1)===this.$store.state.fileExtensionSearch)&&!(this.$store.state.fileNameSearch.length&&!e.name.includes(this.$store.state.fileNameSearch))))}},props:{folderData:{required:!0,type:Object}},watch:{file(e){this.processFile(e)}},components:{FileComponent:J}}),ie=ae,se=(0,v.Z)(ie,ee,te,!1,null,"76c50e06",null),re=se.exports,oe=i.ZP.extend({name:"Home",data:()=>({fileLoading:!1,fileError:!1,fileErrors:[],file:void 0,rawFilesData:[],rawFoldersData:[]}),mounted(){this.fetchData()},computed:{files(){return this.rawFilesData.filter((e=>(!this.$store.state.fileExtensionSearch.length||e.full_name.slice(e.full_name.lastIndexOf(".")+1)===this.$store.state.fileExtensionSearch)&&(!(this.$store.state.fileNameSearch.length&&!e.name.includes(this.$store.state.fileNameSearch))&&!e?.folder_id)))}},methods:{async fetchData(){this.rawFilesData=(await U.GetFiles()).data,this.rawFoldersData=(await G.GetFolders()).data,this.computeWeight()},computeWeight(){let e=0;this.rawFilesData.forEach((t=>{e+=t.size})),this.$store.commit("setWeight",e)},async addFolder(){await G.AddFolder((Math.random()+1).toString(36)),this.fetchData()},validateFile(e){return this.fileError=!1,this.fileErrors=[],!!e&&(e.size>2e7&&(this.fileError=!0,this.fileErrors.push("Размер файла не должен превышан 20мб")),".php"===e.name.slice(-4)&&(this.fileError=!0,this.fileErrors.push("Нельзя загружать .php файлы")),!this.fileErrors.length)},async processFile(e){this.validateFile(e)&&e&&(this.fileLoading=!0,await U.UploadFile(e),this.fileLoading=!1,this.fetchData())}},watch:{file(e){this.processFile(e)}},components:{FolderComponent:re,FileComponent:J}}),le=oe,ne=(0,v.Z)(le,k,S,!1,null,"43be0da6",null),ce=ne.exports,ue=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"auth-wrapper"},["register"===e.mode?t("RegistrationComponent",{on:{switch:function(t){e.mode="login"},registered:function(t){e.mode="login"}}}):e._e(),"login"===e.mode?t("LoginComponent",{on:{switch:function(t){e.mode="register"}}}):e._e()],1)},de=[],fe=a(1653),he=a(4886),pe=a(5125),me=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t($.Z,{staticStyle:{"min-width":"370px"}},[t(pe.Z,[t(he.EB,[e._v(" Вход ")]),t(he.ZB,[t(pe.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(d.Z,{attrs:{rules:e.emailRules,label:"Почтовый ящик",required:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t(d.Z,{attrs:{counter:8,rules:e.passRules,label:"Кодовое слово",required:""},model:{value:e.pass,callback:function(t){e.pass=t},expression:"pass"}})],1)],1),t(he.h7,[t(n.Z,{attrs:{color:"success",variant:"outlined"},on:{click:function(t){e.form.validate(),e.login()}}},[e._v("войти")]),t(u.Z),t(n.Z,{attrs:{text:""},on:{click:function(t){return e.$emit("switch")}}},[e._v("Регистрация")])],1)],1)],1),t(fe.Z,{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticStyle:{"margin-top":"10px"},attrs:{transition:"slide-x-transition",dense:"",prominent:"",type:"error"}},[e._v("Пользователь не найден")])],1)},xe=[],ve=i.ZP.extend({name:"LoginComponent",data:()=>({pass:"",email:"",valid:!1,error:!1,passRules:[e=>/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{8,}$/.test(e)||"цифры, спец символы, буквы: строчные, заглавные"],emailRules:[e=>/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(e)||"неправильная почта"]}),methods:{async login(){await this.$store.dispatch("fetchUser",{email:this.email,pass:this.pass}),this.$store.state.user.token.length?this.$router.replace({name:"home"}):(this.error=!0,setTimeout((()=>{this.error=!1}),3500))}},computed:{form(){return this.$refs.form}}}),_e=ve,Ze=(0,v.Z)(_e,me,xe,!1,null,"e079d4ce",null),be=Ze.exports,ge=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t($.Z,{staticStyle:{"min-width":"370px"}},[t(pe.Z,[t(he.EB,[e._v(" Регистрация ")]),t(he.ZB,[t(pe.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(d.Z,{attrs:{rules:e.nameRules,label:"Логин",required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(d.Z,{attrs:{rules:e.emailRules,label:"Почтовый ящик",required:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t(d.Z,{attrs:{counter:8,rules:e.passRules,label:"Кодовое слово",required:""},model:{value:e.pass,callback:function(t){e.pass=t},expression:"pass"}})],1)],1),t(he.h7,[t(n.Z,{attrs:{color:"success",variant:"outlined"},on:{click:function(t){e.form.validate(),e.register()}}},[e._v("Утвердить")]),t(u.Z),t(n.Z,{attrs:{text:""},on:{click:function(t){return e.$emit("switch")}}},[e._v("Вход")])],1)],1)],1),t(fe.Z,{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticStyle:{"margin-top":"10px"},attrs:{transition:"slide-x-transition",dense:"",prominent:"",type:"error"}},[e._v("Такой пользователь уже существует")])],1)},we=[],ye=i.ZP.extend({name:"RegistrationComponent",data:()=>({name:"",pass:"",email:"",valid:!1,error:!1,passRules:[e=>/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{8,}$/.test(e)||"цифры, спец символы, буквы: строчные, заглавные"],emailRules:[e=>/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(e)||"неправильная почта"],nameRules:[e=>!!e||"введите логин"]}),methods:{async register(){const e=await D.Register(this.email,this.pass,this.name);422===e.status?(this.error=!0,setTimeout((()=>[this.error=!1]),3500)):this.$emit("registered")}},computed:{form(){return this.$refs.form}}}),Fe=ye,$e=(0,v.Z)(Fe,ge,we,!1,null,"11baf699",null),Ee=$e.exports,ke=i.ZP.extend({name:"AuthView",data:()=>({mode:"register"}),mounted(){D.Logout(),this.$store.commit("dropUser")},methods:{},components:{RegistrationComponent:Ee,LoginComponent:be}}),Se=ke,Ce=(0,v.Z)(Se,ue,de,!1,null,"2bbcbd43",null),ze=Ce.exports;i.ZP.use(F.ZP);const Pe=[{path:"/",name:"home",component:ce},{path:"/auth",name:"auth",component:ze}],De=new F.ZP({routes:Pe});De.beforeEach(((e,t,a)=>{"auth"!==e.name&&""===R.state.user.token?a({name:"auth"}):a()}));var Le=De,Ne=a(8864);i.ZP.use(Ne.Z);var Te=new Ne.Z({});i.ZP.config.productionTip=!1,new i.ZP({router:Le,store:R,vuetify:Te,render:e=>e(y)}).$mount("#app")}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,i,s,r){if(!i){var o=1/0;for(u=0;u<e.length;u++){i=e[u][0],s=e[u][1],r=e[u][2];for(var l=!0,n=0;n<i.length;n++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](i[n])}))?i.splice(n--,1):(l=!1,r<o&&(o=r));if(l){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,s,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,r,o=i[0],l=i[1],n=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(s in l)a.o(l,s)&&(a.m[s]=l[s]);if(n)var u=n(a)}for(t&&t(i);c<o.length;c++)r=o[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},i=self["webpackChunkvita_disk"]=self["webpackChunkvita_disk"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(5208)}));i=a.O(i)})();
//# sourceMappingURL=app.28a7100e.js.map